<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/c0b628ab48496dde.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c0b628ab48496dde.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-bc4ae192cef394bd.js" defer=""></script><script src="/_next/static/chunks/framework-839af705687712fa.js" defer=""></script><script src="/_next/static/chunks/main-28132e797e9512a4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f2548a56e30dbcef.js" defer=""></script><script src="/_next/static/chunks/605040ef-d91e3f03124f1fe4.js" defer=""></script><script src="/_next/static/chunks/pages/docs/210401-scrape-jobplanet-3d2a3da0ed37749c.js" defer=""></script><script src="/_next/static/lnILDB8AGnlhznHr7KHpJ/_buildManifest.js" defer=""></script><script src="/_next/static/lnILDB8AGnlhznHr7KHpJ/_ssgManifest.js" defer=""></script><style id="__jsx-3251069789">a.jsx-3251069789{-webkit-text-decoration:none;text-decoration:none;}a.jsx-3251069789:hover{opacity:1;}div.jsx-3251069789{position:absolute;margin-top:-70px;}</style><style id="__jsx-1786922009">a.jsx-1786922009{color:black;-webkit-text-decoration:none;text-decoration:none;}a.jsx-1786922009:hover{opacity:1;}a.jsx-1786922009 .heading::after{opacity:0;color:var(--toc-border);content:'  #';-webkit-transition:opacity 250ms ease;transition:opacity 250ms ease;}a.jsx-1786922009 .heading:hover::after{opacity:1;}</style><style id="__jsx-4199775075">.icon.jsx-4199775075{display:inline-block;position:relative;font-size:inherit;width:1em;height:1em;min-width:16px;box-sizing:content-box;color:inherit;}.icon.jsx-4199775075 svg{z-index:10;position:relative;display:block;fill:currentcolor;stroke:currentcolor;width:100%;height:100%;}</style><style id="__jsx-831781359">.code.jsx-831781359{position:relative;}.code.jsx-831781359 button.jsx-831781359{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:absolute;color:inherit;background:var(--code-background);top:13px;right:11px;border-radius:4px;border:none;font-size:15px;}pre.jsx-831781359{white-space:pre-wrap;}</style><style id="__jsx-2743484325">nav.jsx-2743484325{border-left:1px solid #dfdfdf;}ul.jsx-2743484325{margin:0;padding:0;}li.jsx-2743484325{list-style-type:none;margin:0 0 1rem 1.5rem;font-size:14px;font-weight:400;}li.jsx-2743484325 a.jsx-2743484325{-webkit-text-decoration:none;text-decoration:none;}li.jsx-2743484325 a.jsx-2743484325:hover,li.active.jsx-2743484325 a.jsx-2743484325{-webkit-text-decoration:underline;text-decoration:underline;}li.padded.jsx-2743484325{padding-left:1rem;}@media screen and (max-width:1000px){nav.jsx-2743484325{display:none;}}</style><style data-styled="" data-styled-version="5.3.6">.fuJDY{height:120px;width:100%;position:relative;bottom:null;background-color:var(--primary);z-index:2;}/*!sc*/
@media screen and (max-width:601px){.fuJDY{height:100px;}}/*!sc*/
data-styled.g1[id="Footer__Wrap-sc-ifmyi6-0"]{content:"fuJDY,"}/*!sc*/
.gBtbfS{height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:0.5rem;box-sizing:border-box;color:var(--dark);padding:1rem 0;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/*!sc*/
data-styled.g2[id="Footer__Foot-sc-ifmyi6-1"]{content:"gBtbfS,"}/*!sc*/
.jmqRFP{text-align:center;font-size:13px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
data-styled.g3[id="Footer__Item-sc-ifmyi6-2"]{content:"jmqRFP,"}/*!sc*/
.kNkMPs{height:26px;font-size:var(--font-size-2);line-height:1.5rem;font-weight:700;background-color:var(--primary);border:1px solid transparent;padding:0 0.7rem;border-radius:100px;}/*!sc*/
data-styled.g4[id="tag__StyledTag-sc-17z8z5z-0"]{content:"kNkMPs,"}/*!sc*/
.eHjIcj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:0.25rem;}/*!sc*/
data-styled.g5[id="tag__Wrap-sc-wv7zn5-0"]{content:"eHjIcj,"}/*!sc*/
.iOydMI{top:0;position:-webkit-sticky;position:sticky;z-index:1;width:100%;}/*!sc*/
data-styled.g6[id="TopNav__Header-sc-aybce4-0"]{content:"iOydMI,"}/*!sc*/
.bZchrV{width:100%;background-color:var(--primary);border-bottom:1px solid transparent;}/*!sc*/
data-styled.g7[id="TopNav__Nav-sc-aybce4-1"]{content:"bZchrV,"}/*!sc*/
.ktICUu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:1rem;max-width:1280px;margin:0 auto;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:1rem 1.5rem 1.1rem;font-size:15px;font-family:var(--sans);}/*!sc*/
data-styled.g8[id="TopNav__NavContent-sc-aybce4-2"]{content:"ktICUu,"}/*!sc*/
.bnXMSm{font-size:25px;font-weight:700;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:all 0.2s ease;transition:all 0.2s ease;}/*!sc*/
.bnXMSm:hover{color:var(--accent);-webkit-transform:scale(1.08);-ms-transform:scale(1.08);transform:scale(1.08);opacity:1;}/*!sc*/
data-styled.g9[id="TopNav__Logo-sc-aybce4-3"]{content:"bnXMSm,"}/*!sc*/
.kPhsbm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1.3rem;padding:0;}/*!sc*/
@media screen and (max-width:600px){.kPhsbm{display:none;}}/*!sc*/
data-styled.g10[id="TopNav__Section-sc-aybce4-4"]{content:"kPhsbm,"}/*!sc*/
.bVwmPO{color:var(--dark);-webkit-text-decoration:none;text-decoration:none;font-weight:600;-webkit-transition:all .2s ease;transition:all .2s ease;}/*!sc*/
.bVwmPO:hover{color:var(--accent);-webkit-transform:translateY(-0.2rem);-ms-transform:translateY(-0.2rem);transform:translateY(-0.2rem);opacity:1;}/*!sc*/
.bVwmPO:active{color:var(--accent);-webkit-transform:translateY(0.2rem);-ms-transform:translateY(0.2rem);transform:translateY(0.2rem);}/*!sc*/
data-styled.g11[id="TopNav__MenuLink-sc-aybce4-5"]{content:"bVwmPO,"}/*!sc*/
.jzhnFu{color:var(--dark);width:48px;height:32px;border:0;border-radius:30px;background:none;}/*!sc*/
.jzhnFu:hover{color:var(--accent);-webkit-transform:translateY(-0.2rem);-ms-transform:translateY(-0.2rem);transform:translateY(-0.2rem);opacity:1;}/*!sc*/
@media screen and (min-width:601px){.jzhnFu{display:none;}}/*!sc*/
data-styled.g12[id="TopNav__MenuButton-sc-aybce4-6"]{content:"jzhnFu,"}/*!sc*/
.hgzrJE{height:auto;}/*!sc*/
data-styled.g14[id="_app__Wrap-sc-xx91a-0"]{content:"hgzrJE,"}/*!sc*/
.dzjNyc{margin:0 auto;padding-top:24px 24px 0;max-width:1280px;}/*!sc*/
data-styled.g15[id="_app__WrapPage-sc-xx91a-1"]{content:"dzjNyc,"}/*!sc*/
.gKXBvV{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;max-width:100vw;}/*!sc*/
data-styled.g16[id="_app__WrapMain-sc-xx91a-2"]{content:"gKXBvV,"}/*!sc*/
.iqkLbd{-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;min-width:0;padding:2rem 1.5rem 3rem;}/*!sc*/
data-styled.g17[id="_app__Main-sc-xx91a-3"]{content:"iqkLbd,"}/*!sc*/
.jecWPd{width:300px;position:-webkit-sticky;position:sticky;-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;top:2.5rem;max-height:calc(100vh - 100px);margin-bottom:1rem;padding:3rem 0 0 1rem;}/*!sc*/
@media screen and (max-width:1000px){.jecWPd{-webkit-flex:0;-ms-flex:0;flex:0;}}/*!sc*/
data-styled.g18[id="_app__ToC-sc-xx91a-4"]{content:"jecWPd,"}/*!sc*/
.HOFWV{font-size:var(--font-size-6);font-weight:600;}/*!sc*/
data-styled.g21[id="_app__Title-sc-xx91a-7"]{content:"HOFWV,"}/*!sc*/
.lhsOaa{padding-left:0.2rem;color:gray;font-size:var(--font-size-2);font-weight:600;}/*!sc*/
data-styled.g23[id="_app__Date-sc-xx91a-9"]{content:"lhsOaa,"}/*!sc*/
.jqpViC{margin:1rem 0 2rem;border-bottom:1px solid var(--gray-light);line-height:0.1em;opacity:0;}/*!sc*/
data-styled.g24[id="_app__Separator-sc-xx91a-10"]{content:"jqpViC,"}/*!sc*/
</style></head><body><div id="__next"><div class="_app__Wrap-sc-xx91a-0 hgzrJE"><header class="TopNav__Header-sc-aybce4-0 iOydMI"><nav class="TopNav__Nav-sc-aybce4-1 bZchrV"><div class="TopNav__NavContent-sc-aybce4-2 ktICUu"><a href="/" class="TopNav__Logo-sc-aybce4-3 bnXMSm">logo</a><section class="TopNav__Section-sc-aybce4-4 kPhsbm"><a href="/docs" class="TopNav__MenuLink-sc-aybce4-5 bVwmPO">Docs</a><a href="https://github.com/dw3624" class="TopNav__MenuLink-sc-aybce4-5 bVwmPO">GitHub</a></section><button class="TopNav__MenuButton-sc-aybce4-6 jzhnFu"><svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="2" fill="var(--black)"></rect><rect y="4" width="16" height="2" fill="var(--black)"></rect><rect y="8" width="16" height="2" fill="var(--black)"></rect></svg></button></div></nav></header><div class="_app__WrapPage-sc-xx91a-1 dzjNyc"><div class="_app__WrapMain-sc-xx91a-2 gKXBvV"><div class="_app__Main-sc-xx91a-3 iqkLbd"><div class="_app__Date-sc-xx91a-9 lhsOaa">2021-04-01</div><div class="_app__Title-sc-xx91a-7 HOFWV">잡플래닛 크롤링하기</div><p class="_app__Desc-sc-xx91a-8 cZapZk"></p><div class="tag__Wrap-sc-wv7zn5-0 eHjIcj"><button class="tag__StyledTag-sc-17z8z5z-0 kNkMPs">crawling</button><button class="tag__StyledTag-sc-17z8z5z-0 kNkMPs">R</button></div><div class="_app__Separator-sc-xx91a-10 jqpViC"></div><article><p>어쩌다 인턴 면접을 보게 됐다. 잡플래닛의 예상 면접 질문을 보면서 대비를 하려고 했는데... 양이 너무 많고 정렬 기능이 없다...!! 게다가 한번에 5개까지 밖에 볼 수 없다. 코딩 공부도 할겸 R을 이용해 내용을 크롤링 후, csv로 정리해 보기로 했다.</p><p>크롤링한 내용은 이하와 같다:<!-- --> <!-- -->면접날짜, 면접난이도, 면접질문, 면접답변 혹은 면접느낌, 면접결과, 면접경험, 도움이돼요 수</p><a href="#참고한-사이트:" class="jsx-1786922009"><h4 class="jsx-3251069789 heading"><div id="참고한-사이트:" class="jsx-3251069789"></div>참고한 사이트:</h4></a><p><a href="https://quantumcomputer.tistory.com/99">R gsub() 함수를 이용한 패턴 치환하기!</a> <a href="https://tidyverse-korea.github.io/r-meetup-x-presser/kaggle/Meetup_3/crawling/getWebR.pdf">R로 웹 데이터를 가져오는 4가지 방법</a> <a href="https://mrkevinna.github.io/%ED%8A%B9%EA%B0%95-%EA%B8%B0%EC%97%85%EB%A6%AC%EB%B7%B0-%EB%B6%84%EC%84%9D-1/">특강 기업리뷰 분석 1</a></p><a href="#코드" class="jsx-1786922009"><h2 class="jsx-3251069789 heading"><div id="코드" class="jsx-3251069789"></div>코드</h2></a><div aria-live="polite" class="jsx-831781359 code"><pre class="jsx-831781359 language-R">library(httr) #요청
library(rvest) #요청
library(tidyverse) #정리
library(stringr) #string처리

# 로그인 화면의 URI를 복사하여 URI 객체에 지정
URI &lt;- &#x27;https://www.jobplanet.co.kr/users/sign_in&#x27;

# 로그인 정보를 이용하여 HTTP를 요청
resp &lt;- POST(url = URI,
             body = list(&#x27;user[email]&#x27; = &#x27;계정&#x27;,
                         &#x27;user[password]&#x27; = &#x27;비밀번호&#x27;))

# 응답 상태코드를 확인, 200의 경우 정상
status_code(x = resp)

# 쿠키만 수집해 myCookies 객체에 할당
# 앞으로 HTTP 요청할 때 myCookies를 활용하면 로그인 상태로 HTML을 받을 수 있다
myCookies &lt;- set_cookies(.cookies = unlist(x = cookies(x = resp)))

url_madup = &#x27;잡플라넷 기업 면접 페이지&#x27;
# 예) https://www.jobplanet.co.kr/companies/000000/interviews
resp = GET(url=url_madup, config = list(cookies = myCookies))
status_code(x=resp)

#기업명
resp %&gt;% read_html() %&gt;% html_node(css=&#x27;body &gt; div.body_wrap &gt; div.cmp_hd &gt; div.new_top_bnr &gt; div &gt; div.top_bnr_wrap &gt; div &gt; div &gt; div.company_info_sec &gt; div.company_info_box &gt; div.company_name &gt; h1 &gt; a&#x27;) %&gt;% html_text()

#작성날짜
dates = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.content_top_ty2 &gt; span.txt1 &gt; span.txt2&#x27;) %&gt;% html_text()
dates = gsub(&#x27;[^0-9]&#x27;,&#x27;&#x27;,dates)
dates
# gsub 참고: https://quantumcomputer.tistory.com/99
## 원래경로: #viewInterviewsList &gt; div &gt; div &gt; section:nth-child(1) &gt; div &gt; div.content_top_ty2 &gt; span.txt1 &gt; span.txt2
## 이거지만 원래경로대로 하면 하나밖에 추출 못함

#면접질문
questions = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; dl &gt; dd:nth-child(2) &gt; span&#x27;) %&gt;% html_text()
questions = gsub(&#x27; {2,}&#x27;,&#x27;&#x27;,questions)
questions
## 원래경로: viewInterviewsList &gt; div &gt; div &gt; section:nth-child(9) &gt; div &gt; div.ctbody_col2 &gt; div &gt; dl &gt; dd:nth-child(2) &gt; span

#마지막페이지
##한페이지당 5건 밖에 보이지 않기 때문에
interviewCnt = resp %&gt;% read_html() %&gt;% html_node(css=&#x27;#viewCompaniesMenu &gt; ul &gt; li.viewInterviews &gt; a &gt; span&#x27;) %&gt;% html_text()
interviewCnt = as.integer(interviewCnt)
pages=ceiling(interviewCnt / 5)

#함수
##개별요소들을 데이터프레임으로 변환
myfunc = function(resp){
  #회사명
  company = resp %&gt;% read_html() %&gt;% html_node(css=&#x27;body &gt; div.body_wrap &gt; div.cmp_hd &gt; div.new_top_bnr &gt; div &gt; div.top_bnr_wrap &gt; div &gt; div &gt; div.company_info_sec &gt; div.company_info_box &gt; div.company_name &gt; h1 &gt; a&#x27;) %&gt;% html_text()

  #면접날짜
  ##면접날짜가 없는 경우가 있어 큰 틀에서 숫자를 추출
  int_date = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; dl&#x27;) %&gt;% html_text()
  int_date = gsub(&#x27;\n|[가-힣]&#x27;,&#x27;&#x27;,int_date)
  int_date = str_trim(int_date)

  #면접난이도
  difficulty = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; dl &gt; dd.blo_box2 &gt; span&#x27;) %&gt;% html_text()

  #면접질문
  questions = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; dl &gt; dd:nth-child(2) &gt; span&#x27;) %&gt;% html_text()
  questions = str_trim(questions)

  #면접답변 혹은 면접느낌
  review = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; dl &gt; dd:nth-child(4)&#x27;) %&gt;% html_text()
  review = str_trim(review)

  #면접결과
  result = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; div.now_box &gt; div &gt; dl &gt; dd:nth-child(2)&#x27;) %&gt;% html_text()
  result = str_trim(result)

  #면접경험
  int_exp = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; div.now_box &gt; div &gt; dl &gt; dd:nth-child(4)&#x27;) %&gt;% html_text()

  #도움이 돼요
  helpful = resp %&gt;% read_html() %&gt;% html_nodes(css = &#x27;div.ctbody_col2 &gt; div &gt; div.btn_group &gt; a.btn_help.helpful.btnval_on &gt; span.notranslate&#x27;) %&gt;% html_text()

  df_page = data.frame(company, int_date, difficulty, questions, review, result, int_exp, helpful)

  return(df_page)
}
df_page=myfunc(resp)
dim(df_page)

# 반복문
df_interview = data.frame()
url_interview = &#x27;https://www.jobplanet.co.kr/companies/000000/interviews&#x27;

for(page in 1:pages){
  cat(&#x27;[&#x27;, page, &#x27;/&#x27;, pages, &#x27;] 진행중... &#x27;,fill=TRUE)
  # 첫페이지 경우 url 그대로 반환
  ## 첫페이지는 url뒤에 페이지 번호가 없다
  ifelse(page==1,
         assign(&#x27;url_page&#x27;,url_interview),
         assign(&#x27;url_page&#x27;,paste0(url_interview,&#x27;?page=&#x27;,page))
  )

  resp = GET(url=url_page, config = list(cookies = myCookies))
  status_code(x=resp)
  df_page = myfunc(resp)
  df_interview = rbind(df_interview,df_page)
  rm(resp,df_page)
}

#확인작업
dim(df_interview) #총 리뷰수와 비교
duplicated(x=df_interview$questions) %&gt;% sum() #중복여부 확인

#csv로 저장 및 불러오기, 확인
write.csv(df_interview,&#x27;C:/Work_R/Others/interview.csv&#x27;)
data=read.csv(&#x27;C:/Work_R/Others/interview.csv&#x27;)
View(data)

</pre><button class="jsx-831781359"><span class="jsx-4199775075 icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><title>Copy</title><rect x="128" y="128" width="336" height="336" rx="57" ry="57" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path d="M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path></svg></span></button></div></article></div><div class="_app__ToC-sc-xx91a-4 jecWPd"><nav class="jsx-2743484325 toc"></nav></div></div></div></div><footer class="Footer__Wrap-sc-ifmyi6-0 fuJDY"><footer class="Footer__Foot-sc-ifmyi6-1 gBtbfS"><div class="Footer__Item-sc-ifmyi6-2 jmqRFP">Nice to meet you!</div><div class="Footer__Item-sc-ifmyi6-2 jmqRFP">©2022. dw3624 All rights reserved.</div></footer></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"markdoc":{"content":{"$$mdtype":"Tag","name":"article","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["어쩌다 인턴 면접을 보게 됐다. 잡플래닛의 예상 면접 질문을 보면서 대비를 하려고 했는데... 양이 너무 많고 정렬 기능이 없다...!! 게다가 한번에 5개까지 밖에 볼 수 없다. 코딩 공부도 할겸 R을 이용해 내용을 크롤링 후, csv로 정리해 보기로 했다."]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["크롤링한 내용은 이하와 같다:"," ","면접날짜, 면접난이도, 면접질문, 면접답변 혹은 면접느낌, 면접결과, 면접경험, 도움이돼요 수"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":4,"id":"참고한-사이트:"},"children":["참고한 사이트:"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://quantumcomputer.tistory.com/99"},"children":["R gsub() 함수를 이용한 패턴 치환하기!"]}," ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://tidyverse-korea.github.io/r-meetup-x-presser/kaggle/Meetup_3/crawling/getWebR.pdf"},"children":["R로 웹 데이터를 가져오는 4가지 방법"]}," ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://mrkevinna.github.io/%ED%8A%B9%EA%B0%95-%EA%B8%B0%EC%97%85%EB%A6%AC%EB%B7%B0-%EB%B6%84%EC%84%9D-1/"},"children":["특강 기업리뷰 분석 1"]}]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"코드"},"children":["코드"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"R"},"children":["library(httr) #요청\nlibrary(rvest) #요청\nlibrary(tidyverse) #정리\nlibrary(stringr) #string처리\n\n# 로그인 화면의 URI를 복사하여 URI 객체에 지정\nURI \u003c- 'https://www.jobplanet.co.kr/users/sign_in'\n\n# 로그인 정보를 이용하여 HTTP를 요청\nresp \u003c- POST(url = URI,\n             body = list('user[email]' = '계정',\n                         'user[password]' = '비밀번호'))\n\n# 응답 상태코드를 확인, 200의 경우 정상\nstatus_code(x = resp)\n\n# 쿠키만 수집해 myCookies 객체에 할당\n# 앞으로 HTTP 요청할 때 myCookies를 활용하면 로그인 상태로 HTML을 받을 수 있다\nmyCookies \u003c- set_cookies(.cookies = unlist(x = cookies(x = resp)))\n\nurl_madup = '잡플라넷 기업 면접 페이지'\n# 예) https://www.jobplanet.co.kr/companies/000000/interviews\nresp = GET(url=url_madup, config = list(cookies = myCookies))\nstatus_code(x=resp)\n\n#기업명\nresp %\u003e% read_html() %\u003e% html_node(css='body \u003e div.body_wrap \u003e div.cmp_hd \u003e div.new_top_bnr \u003e div \u003e div.top_bnr_wrap \u003e div \u003e div \u003e div.company_info_sec \u003e div.company_info_box \u003e div.company_name \u003e h1 \u003e a') %\u003e% html_text()\n\n#작성날짜\ndates = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.content_top_ty2 \u003e span.txt1 \u003e span.txt2') %\u003e% html_text()\ndates = gsub('[^0-9]','',dates)\ndates\n# gsub 참고: https://quantumcomputer.tistory.com/99\n## 원래경로: #viewInterviewsList \u003e div \u003e div \u003e section:nth-child(1) \u003e div \u003e div.content_top_ty2 \u003e span.txt1 \u003e span.txt2\n## 이거지만 원래경로대로 하면 하나밖에 추출 못함\n\n#면접질문\nquestions = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e dl \u003e dd:nth-child(2) \u003e span') %\u003e% html_text()\nquestions = gsub(' {2,}','',questions)\nquestions\n## 원래경로: viewInterviewsList \u003e div \u003e div \u003e section:nth-child(9) \u003e div \u003e div.ctbody_col2 \u003e div \u003e dl \u003e dd:nth-child(2) \u003e span\n\n#마지막페이지\n##한페이지당 5건 밖에 보이지 않기 때문에\ninterviewCnt = resp %\u003e% read_html() %\u003e% html_node(css='#viewCompaniesMenu \u003e ul \u003e li.viewInterviews \u003e a \u003e span') %\u003e% html_text()\ninterviewCnt = as.integer(interviewCnt)\npages=ceiling(interviewCnt / 5)\n\n#함수\n##개별요소들을 데이터프레임으로 변환\nmyfunc = function(resp){\n  #회사명\n  company = resp %\u003e% read_html() %\u003e% html_node(css='body \u003e div.body_wrap \u003e div.cmp_hd \u003e div.new_top_bnr \u003e div \u003e div.top_bnr_wrap \u003e div \u003e div \u003e div.company_info_sec \u003e div.company_info_box \u003e div.company_name \u003e h1 \u003e a') %\u003e% html_text()\n\n  #면접날짜\n  ##면접날짜가 없는 경우가 있어 큰 틀에서 숫자를 추출\n  int_date = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e dl') %\u003e% html_text()\n  int_date = gsub('\\n|[가-힣]','',int_date)\n  int_date = str_trim(int_date)\n\n  #면접난이도\n  difficulty = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e dl \u003e dd.blo_box2 \u003e span') %\u003e% html_text()\n\n  #면접질문\n  questions = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e dl \u003e dd:nth-child(2) \u003e span') %\u003e% html_text()\n  questions = str_trim(questions)\n\n  #면접답변 혹은 면접느낌\n  review = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e dl \u003e dd:nth-child(4)') %\u003e% html_text()\n  review = str_trim(review)\n\n  #면접결과\n  result = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e div.now_box \u003e div \u003e dl \u003e dd:nth-child(2)') %\u003e% html_text()\n  result = str_trim(result)\n\n  #면접경험\n  int_exp = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e div.now_box \u003e div \u003e dl \u003e dd:nth-child(4)') %\u003e% html_text()\n\n  #도움이 돼요\n  helpful = resp %\u003e% read_html() %\u003e% html_nodes(css = 'div.ctbody_col2 \u003e div \u003e div.btn_group \u003e a.btn_help.helpful.btnval_on \u003e span.notranslate') %\u003e% html_text()\n\n  df_page = data.frame(company, int_date, difficulty, questions, review, result, int_exp, helpful)\n\n  return(df_page)\n}\ndf_page=myfunc(resp)\ndim(df_page)\n\n# 반복문\ndf_interview = data.frame()\nurl_interview = 'https://www.jobplanet.co.kr/companies/000000/interviews'\n\nfor(page in 1:pages){\n  cat('[', page, '/', pages, '] 진행중... ',fill=TRUE)\n  # 첫페이지 경우 url 그대로 반환\n  ## 첫페이지는 url뒤에 페이지 번호가 없다\n  ifelse(page==1,\n         assign('url_page',url_interview),\n         assign('url_page',paste0(url_interview,'?page=',page))\n  )\n\n  resp = GET(url=url_page, config = list(cookies = myCookies))\n  status_code(x=resp)\n  df_page = myfunc(resp)\n  df_interview = rbind(df_interview,df_page)\n  rm(resp,df_page)\n}\n\n#확인작업\ndim(df_interview) #총 리뷰수와 비교\nduplicated(x=df_interview$questions) %\u003e% sum() #중복여부 확인\n\n#csv로 저장 및 불러오기, 확인\nwrite.csv(df_interview,'C:/Work_R/Others/interview.csv')\ndata=read.csv('C:/Work_R/Others/interview.csv')\nView(data)\n\n"]}]},"frontmatter":{"title":"잡플래닛 크롤링하기","date":"2021-04-01","tags":"crawling R"},"file":{"path":"/docs/210401-scrape-jobplanet.md"}}},"__N_SSG":true},"page":"/docs/210401-scrape-jobplanet","query":{},"buildId":"lnILDB8AGnlhznHr7KHpJ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>