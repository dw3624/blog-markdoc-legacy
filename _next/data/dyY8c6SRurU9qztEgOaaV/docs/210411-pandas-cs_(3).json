{"pageProps":{"markdoc":{"content":{"$$mdtype":"Tag","name":"article","attributes":{},"children":[{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["import pandas as pd\n"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"9.-combine-data-sets"},"children":["9. Combine Data Sets"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["adf = pd.DataFrame({'x1':['A','B','C'], 'x2':[1,2,3]})\nadf\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["bdf = pd.DataFrame({'x1':['A','B','D'], 'x3':['T','F','T']})\nbdf\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x3</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>T</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>F</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>D</td>"," ","<td>T</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"standard-joins"},"children":["Standard joins"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(adf, bdf, how = 'left',on = 'x1')\n    # Join matching rows from bdf to adf\n    # x1열 기준 일치하는 행을 bdf에서 adf로 합침\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>x3</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","<td>T</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","<td>F</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","<td>NaN</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(adf, bdf, how = 'right', on = 'x1')\n    # Join mathching rows from adf to bdf\n    # x1열 기준 일치하는 행을 adf에서 bdf로 합침\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>x3</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1.0</td>"," ","<td>T</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2.0</td>"," ","<td>F</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>D</td>"," ","<td>NaN</td>"," ","<td>T</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(adf, bdf, how = 'inner', on = 'x1')\n    # Join data. Retain only rows in both sets.\n    # 양쪽 df에 공통적으로 존재하는 행만 합침\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>x3</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","<td>T</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","<td>F</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(adf, bdf, how = 'outer', on = 'x1')\n    # Join data. Retain all values, all rows\n    # 모든 값, 행을 합침.\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>x3</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1.0</td>"," ","<td>T</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2.0</td>"," ","<td>F</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3.0</td>"," ","<td>NaN</td>"," ","</tr>"," ","<tr>"," ","<th>3</th>"," ","<td>D</td>"," ","<td>NaN</td>"," ","<td>T</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"filtering-joins"},"children":["Filtering joins"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["adf[adf.x1.isin(bdf.x1)]\n    # All rows in adf that have a mathch in bdf.\n    # bdf와 일치하는 값을 가진 adf의 모든 행\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["adf[~adf.x1.isin(bdf.x1)]\n    # All rows in adf that do not have a match in bdf.\n    # bdf와 일치하는 값이 없는 adf의 모든 행\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":3,"id":"set-like-operations"},"children":["Set-like Operations"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["ydf = pd.DataFrame({'x1':['A','B','C'],'x2':[1,2,3]})\nydf\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["zdf = pd.DataFrame({'x1':['B','C','D'],'x2':[2,3,4]})\nzdf\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>D</td>"," ","<td>4</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(ydf,zdf)\n    # Rows that appear in both ydf and zdf (Intersection)\n    # ydf와 zdf에서 공통되는 행 (교집합)\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(ydf, zdf, how = 'outer')\n    # Rows that appear in either or both ydf and zdf (Union)\n    # ydf와 zdf에서 보이는 모든 행 (합집합)\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","</tr>"," ","<tr>"," ","<th>3</th>"," ","<td>D</td>"," ","<td>4</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(ydf, zdf, how = 'outer', indicator = True)\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>_merge</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","<td>left_only</td>"," ","</tr>"," ","<tr>"," ","<th>1</th>"," ","<td>B</td>"," ","<td>2</td>"," ","<td>both</td>"," ","</tr>"," ","<tr>"," ","<th>2</th>"," ","<td>C</td>"," ","<td>3</td>"," ","<td>both</td>"," ","</tr>"," ","<tr>"," ","<th>3</th>"," ","<td>D</td>"," ","<td>4</td>"," ","<td>right_only</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["pd.merge(ydf, zdf, how = 'outer', indicator = True).query('_merge == \"left_only\"')\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","<th>_merge</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","<td>left_only</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"python"},"children":["(pd.merge(ydf, zdf, how = 'outer', indicator = True)\n    .query('_merge == \"left_only\"')\n    .drop(columns=['_merge']))\n    # Rows that appear in ydf but not zdf (Setdiff)\n    # zdf에는 없지만 ydf에는 있는 행 (차집합, ydf - zdf)\n"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["<div>"," ","<style scoped>"," ",".dataframe tbody tr th:only-of-type {"," ","vertical-align: middle;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe tbody tr th {"," ","vertical-align: top;"," ","}"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[".dataframe thead th {"," ","text-align: right;"," ","}"," ","</style>"," ","<table border=\"1\" class=\"dataframe\">"," ","<thead>"," ","<tr style=\"text-align: right;\">"," ","<th></th>"," ","<th>x1</th>"," ","<th>x2</th>"," ","</tr>"," ","</thead>"," ","<tbody>"," ","<tr>"," ","<th>0</th>"," ","<td>A</td>"," ","<td>1</td>"," ","</tr>"," ","</tbody>"," ","</table>"," ","</div>"]}]},"frontmatter":{"title":"Pandas Cheat Sheet (3)","tags":"pandas python"},"file":{"path":"/docs/210411-pandas-cs_(3).md"}}},"__N_SSG":true}