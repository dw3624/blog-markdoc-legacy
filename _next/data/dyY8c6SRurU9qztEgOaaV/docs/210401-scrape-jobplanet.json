{"pageProps":{"markdoc":{"content":{"$$mdtype":"Tag","name":"article","attributes":{},"children":[{"$$mdtype":"Tag","name":"p","attributes":{},"children":["어쩌다 인턴 면접을 보게 됐다. 잡플래닛의 예상 면접 질문을 보면서 대비를 하려고 했는데... 양이 너무 많고 정렬 기능이 없다...!! 게다가 한번에 5개까지 밖에 볼 수 없다. 코딩 공부도 할겸 R을 이용해 내용을 크롤링 후, csv로 정리해 보기로 했다."]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":["크롤링한 내용은 이하와 같다:"," ","면접날짜, 면접난이도, 면접질문, 면접답변 혹은 면접느낌, 면접결과, 면접경험, 도움이돼요 수"]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":4,"id":"참고한-사이트:"},"children":["참고한 사이트:"]},{"$$mdtype":"Tag","name":"p","attributes":{},"children":[{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://quantumcomputer.tistory.com/99"},"children":["R gsub() 함수를 이용한 패턴 치환하기!"]}," ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://tidyverse-korea.github.io/r-meetup-x-presser/kaggle/Meetup_3/crawling/getWebR.pdf"},"children":["R로 웹 데이터를 가져오는 4가지 방법"]}," ",{"$$mdtype":"Tag","name":"a","attributes":{"href":"https://mrkevinna.github.io/%ED%8A%B9%EA%B0%95-%EA%B8%B0%EC%97%85%EB%A6%AC%EB%B7%B0-%EB%B6%84%EC%84%9D-1/"},"children":["특강 기업리뷰 분석 1"]}]},{"$$mdtype":"Tag","name":"Heading","attributes":{"level":2,"id":"코드"},"children":["코드"]},{"$$mdtype":"Tag","name":"Fence","attributes":{"data-language":"R"},"children":["library(httr) #요청\nlibrary(rvest) #요청\nlibrary(tidyverse) #정리\nlibrary(stringr) #string처리\n\n# 로그인 화면의 URI를 복사하여 URI 객체에 지정\nURI <- 'https://www.jobplanet.co.kr/users/sign_in'\n\n# 로그인 정보를 이용하여 HTTP를 요청\nresp <- POST(url = URI,\n             body = list('user[email]' = '계정',\n                         'user[password]' = '비밀번호'))\n\n# 응답 상태코드를 확인, 200의 경우 정상\nstatus_code(x = resp)\n\n# 쿠키만 수집해 myCookies 객체에 할당\n# 앞으로 HTTP 요청할 때 myCookies를 활용하면 로그인 상태로 HTML을 받을 수 있다\nmyCookies <- set_cookies(.cookies = unlist(x = cookies(x = resp)))\n\nurl_madup = '잡플라넷 기업 면접 페이지'\n# 예) https://www.jobplanet.co.kr/companies/000000/interviews\nresp = GET(url=url_madup, config = list(cookies = myCookies))\nstatus_code(x=resp)\n\n#기업명\nresp %>% read_html() %>% html_node(css='body > div.body_wrap > div.cmp_hd > div.new_top_bnr > div > div.top_bnr_wrap > div > div > div.company_info_sec > div.company_info_box > div.company_name > h1 > a') %>% html_text()\n\n#작성날짜\ndates = resp %>% read_html() %>% html_nodes(css = 'div.content_top_ty2 > span.txt1 > span.txt2') %>% html_text()\ndates = gsub('[^0-9]','',dates)\ndates\n# gsub 참고: https://quantumcomputer.tistory.com/99\n## 원래경로: #viewInterviewsList > div > div > section:nth-child(1) > div > div.content_top_ty2 > span.txt1 > span.txt2\n## 이거지만 원래경로대로 하면 하나밖에 추출 못함\n\n#면접질문\nquestions = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > dl > dd:nth-child(2) > span') %>% html_text()\nquestions = gsub(' {2,}','',questions)\nquestions\n## 원래경로: viewInterviewsList > div > div > section:nth-child(9) > div > div.ctbody_col2 > div > dl > dd:nth-child(2) > span\n\n#마지막페이지\n##한페이지당 5건 밖에 보이지 않기 때문에\ninterviewCnt = resp %>% read_html() %>% html_node(css='#viewCompaniesMenu > ul > li.viewInterviews > a > span') %>% html_text()\ninterviewCnt = as.integer(interviewCnt)\npages=ceiling(interviewCnt / 5)\n\n#함수\n##개별요소들을 데이터프레임으로 변환\nmyfunc = function(resp){\n  #회사명\n  company = resp %>% read_html() %>% html_node(css='body > div.body_wrap > div.cmp_hd > div.new_top_bnr > div > div.top_bnr_wrap > div > div > div.company_info_sec > div.company_info_box > div.company_name > h1 > a') %>% html_text()\n\n  #면접날짜\n  ##면접날짜가 없는 경우가 있어 큰 틀에서 숫자를 추출\n  int_date = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > dl') %>% html_text()\n  int_date = gsub('\\n|[가-힣]','',int_date)\n  int_date = str_trim(int_date)\n\n  #면접난이도\n  difficulty = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > dl > dd.blo_box2 > span') %>% html_text()\n\n  #면접질문\n  questions = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > dl > dd:nth-child(2) > span') %>% html_text()\n  questions = str_trim(questions)\n\n  #면접답변 혹은 면접느낌\n  review = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > dl > dd:nth-child(4)') %>% html_text()\n  review = str_trim(review)\n\n  #면접결과\n  result = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > div.now_box > div > dl > dd:nth-child(2)') %>% html_text()\n  result = str_trim(result)\n\n  #면접경험\n  int_exp = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > div.now_box > div > dl > dd:nth-child(4)') %>% html_text()\n\n  #도움이 돼요\n  helpful = resp %>% read_html() %>% html_nodes(css = 'div.ctbody_col2 > div > div.btn_group > a.btn_help.helpful.btnval_on > span.notranslate') %>% html_text()\n\n  df_page = data.frame(company, int_date, difficulty, questions, review, result, int_exp, helpful)\n\n  return(df_page)\n}\ndf_page=myfunc(resp)\ndim(df_page)\n\n# 반복문\ndf_interview = data.frame()\nurl_interview = 'https://www.jobplanet.co.kr/companies/000000/interviews'\n\nfor(page in 1:pages){\n  cat('[', page, '/', pages, '] 진행중... ',fill=TRUE)\n  # 첫페이지 경우 url 그대로 반환\n  ## 첫페이지는 url뒤에 페이지 번호가 없다\n  ifelse(page==1,\n         assign('url_page',url_interview),\n         assign('url_page',paste0(url_interview,'?page=',page))\n  )\n\n  resp = GET(url=url_page, config = list(cookies = myCookies))\n  status_code(x=resp)\n  df_page = myfunc(resp)\n  df_interview = rbind(df_interview,df_page)\n  rm(resp,df_page)\n}\n\n#확인작업\ndim(df_interview) #총 리뷰수와 비교\nduplicated(x=df_interview$questions) %>% sum() #중복여부 확인\n\n#csv로 저장 및 불러오기, 확인\nwrite.csv(df_interview,'C:/Work_R/Others/interview.csv')\ndata=read.csv('C:/Work_R/Others/interview.csv')\nView(data)\n\n"]}]},"frontmatter":{"title":"잡플래닛 크롤링하기","date":"2021-04-01","tags":"crawling R"},"file":{"path":"/docs/210401-scrape-jobplanet.md"}}},"__N_SSG":true}